# Деплой на Vercel

Этот проект настроен для деплоя на Vercel с использованием serverless функций и Vercel KV для хранения данных.

## Структура проекта

- `src/` - React фронтенд приложение
- `api/` - Serverless функции для Vercel
- `vercel.json` - Конфигурация Vercel
- `package.json` - Зависимости и скрипты

## Быстрый старт

### 1. Установка зависимостей

```bash
npm install
```

### 2. Локальная разработка

Для локальной разработки фронтенда:

```bash
npm run dev
```

Для локальной разработки с бэкендом (используя старый Express сервер):

```bash
node server.cjs
```

### 3. Деплой на Vercel

#### Вариант A: Через Vercel CLI

1. Установите Vercel CLI:
```bash
npm i -g vercel
```

2. Войдите в аккаунт:
```bash
vercel login
```

3. Деплой:
```bash
vercel
```

#### Вариант B: Через GitHub

1. Загрузите проект в GitHub репозиторий
2. Перейдите на [vercel.com](https://vercel.com)
3. Импортируйте репозиторий
4. Vercel автоматически определит настройки из `vercel.json`

### 4. Настройка Vercel KV (опционально)

Для персистентного хранения данных:

1. В панели Vercel перейдите в раздел Storage
2. Создайте новую KV базу данных
3. Скопируйте переменные окружения (они будут автоматически доступны в функциях)

**Примечание:** Если Vercel KV не настроен, приложение будет использовать in-memory хранилище (данные не сохраняются между перезапусками функций).

## API Endpoints

После деплоя доступны следующие endpoints:

- `GET /api/state` - Получить состояние дашборда
- `POST /api/state` - Сохранить состояние дашборда
- `GET /api/roadmap` - Получить все элементы roadmap
- `GET /api/roadmap?quarter=Q1` - Получить элементы по кварталу
- `POST /api/roadmap` - Создать новый элемент
- `PUT /api/roadmap/[id]` - Обновить элемент
- `DELETE /api/roadmap/[id]` - Удалить элемент
- `POST /api/roadmap/[id]/toggle` - Переключить статус выполнения
- `GET /api/export` - Экспортировать данные
- `POST /api/reset` - Сбросить данные к значениям по умолчанию

## Переменные окружения

Для использования Vercel KV, переменные окружения настраиваются автоматически при создании KV базы в панели Vercel.

## Локальная разработка с Vercel функциями

Для тестирования serverless функций локально:

```bash
vercel dev
```

Это запустит локальный сервер с поддержкой Vercel функций.

## Важные замечания

1. **SQLite не работает на Vercel** - используется Vercel KV или in-memory хранилище
2. **Статические файлы** - React приложение собирается в `dist/` и раздается как статические файлы
3. **CORS** - Все API endpoints настроены с CORS заголовками для работы с фронтендом
4. **Данные по умолчанию** - При первом запуске загружаются данные по умолчанию для roadmap

## Troubleshooting

### Функции не работают

- Убедитесь, что файлы в папке `api/` используют правильный синтаксис экспорта
- Проверьте логи в панели Vercel

### Данные не сохраняются

- Настройте Vercel KV для персистентного хранения
- Или используйте внешнюю базу данных (PostgreSQL, MongoDB и т.д.)

### CORS ошибки

- Проверьте, что все API функции устанавливают правильные CORS заголовки
- Убедитесь, что фронтенд использует правильный `API_BASE_URL`
